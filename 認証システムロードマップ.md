## 🎯 Phase 1: JWT生成・管理（高優先度）
### Phase 1A: Rails API側のJWT生成基盤
JWT gemの追加

jwt gemをGemfileに追加
bundle install実行
JWT設定・ヘルパーの作成

JWT秘密鍵の環境変数設定
JWTエンコード/デコードのヘルパーメソッド作成
トークン有効期限の設定
Userモデルの作成（基本版）

マイグレーション作成（email, google_id, name等）
Userモデルの基本メソッド実装
### Phase 1B: Rails API認証エンドポイントの強化
auth_controller.rbの拡張

ユーザー情報のDB保存/更新
JWTトークン生成
レスポンス形式の標準化
JWT認証ミドルウェアの作成

Authorizationヘッダーの検証
JWTデコード・検証
current_userの設定
Phase 1C: Next.js側のJWT受信・格納
next-auth設定の変更

signInコールバックでRails JWTを受信
JWTをnext-authセッションに格納
セッション型定義の更新
API呼び出し用ヘルパーの作成

Rails APIへのリクエスト時にJWT自動付与
認証エラー時の処理
## 🔒 Phase 2: 認証基盤強化（中優先度）
### Phase 2A: 保護されたAPIエンドポイント実装
Rails API認証の実装

before_actionでの認証チェック
認証が必要なコントローラーの設定
未認証時のエラーレスポンス
サンプル保護エンドポイントの作成

/api/user/profile - ユーザー情報取得
/api/user/update - ユーザー情報更新
動作確認用の基本CRUD
### Phase 2B: フロントエンド認証状態管理
認証状態に基づくUI制御

ログイン状態での画面表示切り替え
認証エラー時のリダイレクト処理
ローディング状態の管理
保護されたページの実装

/mypageの機能強化
ユーザープロフィール表示/編集
Rails APIとの連携確認
### Phase 2C: セキュリティ強化
トークン管理の改善

リフレッシュトークン機能
トークン自動更新
セキュアなトークン保存
CORS・セキュリティ設定

Rails API CORS設定の最適化
セキュリティヘッダーの追加
XSS/CSRF対策
## 🎨 Phase 3: UX/エラーハンドリング改善（低優先度）
### Phase 3A: エラーハンドリングの標準化
Rails API側エラーレスポンス

エラーコードの標準化
詳細なエラーメッセージ
ログ記録の改善
フロントエンド側エラー処理

エラー表示コンポーネント
トースト通知の実装
再試行機能
### Phase 3B: ログイン体験の改善
ログインフローの最適化

リダイレクト先の詳細制御
ログイン後の適切なページ遷移
セッション復帰時の処理
ユーザーフィードバック

ログイン状態の視覚的表示
認証プロセスのローディング表示
成功/失敗メッセージ
### Phase 3C: 高度な機能・最適化
パフォーマンス最適化

JWTキャッシュ戦略
APIレスポンス最適化
フロントエンド認証状態キャッシュ
監視・ログ機能

認証ログの記録
不正アクセス検知
パフォーマンス監視

## 🎯 各Phaseの完了基準
### Phase 1完了時
✅ Rails APIがJWTを生成・返却 \
✅ Next.jsがJWTを受信・セッションに格納\
✅ 基本的なユーザー情報がDBに保存
### Phase 2完了時
✅ 保護されたAPIエンドポイントが動作\
✅ JWT認証が正しく機能\
✅ 認証エラー時の適切な処理
### Phase 3完了時
✅ ユーザーフレンドリーなエラー処理\
✅ スムーズなログイン体験\
✅ 本番運用可能な安定性
